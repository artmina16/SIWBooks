<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>siw-Books Homepage</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <!-- Custom CSS -->
  <link href="/css/home.css" rel="stylesheet">

</head>

<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark custom-navbar">
  <div class="container-fluid px-4">
    <div class="row w-100 align-items-center g-0">
      <div class="col-6 d-flex align-items-center">
        <a class="navbar-brand d-flex align-items-center" href="/">
          <i class="bi bi-book-half me-2" style="font-size: 1.5rem;"></i>
          <span class="logo-text">siw-Books</span>
        </a>
      </div>
	  <div class="col-6 d-flex justify-content-end align-items-center gap-3">
          <!-- Utente autenticato -->
          <th:block th:if="${#authorization.expression('isAuthenticated()')}">
            <a href="/profile" class="btn btn-outline-light rounded-pill px-3 fw-bold">
              <i class="bi bi-person-circle me-1"></i> Profile
            </a>
            <a href="/logout" class="btn btn-light rounded-pill px-3 fw-bold">Logout</a>
          </th:block>

          <!-- Utente anonimo -->
          <th:block th:if="${#authorization.expression('isAnonymous()')}">
            <a href="/login" class="btn btn-outline-primary rounded-pill px-3 fw-bold">Login</a>
            <a href="/register" class="btn btn-primary rounded-pill px-4 fw-bold">Sign Up</a>
          </th:block>
        </div>
      </div>
    </div>
  </div>
</nav>

<!-- Contenuto principale -->
<main class="flex-grow-1">

  <!-- Sezione introduttiva -->
  <div class="wave-section">
    <div class="container text-center py-5">
      <h1 class="display-3 fw-bold mb-2">Welcome to siw-Books</h1>
      <p class="fs-4 mb-3">Explore our library and discover your next read.</p>
	 <!-- <p class="fs-6 text-muted mt-3">
	    Want to leave a review on our books?
	    <a href="/login" style="color: rgb(83, 166, 166); font-weight: 600; text-decoration: none;">Log in</a>
	    or
	    <a href="/register" style="color: rgb(83, 166, 166); font-weight: 600; text-decoration: none;">Sign Up</a>
	  </p>-->
      <div class="d-flex justify-content-center gap-3">
        <a href="/books" class="btn btn-outline-primary rounded-pill px-4 fw-bold mt-4">View All Books</a>
        <a href="/authors" class="btn btn-primary rounded-pill px-4 fw-bold mt-4">View All Authors</a>
      </div>
    </div>

    <!-- Onda decorativa -->
    <div class="wave-bottom">
      <svg class="wave-svg" viewBox="0 0 1920 320" preserveAspectRatio="none">
        <path fill="#ffffff" fill-opacity="1"
          d="M0,224C160,192,320,128,480,122.7C640,117,800,171,960,176C1120,181,1280,139,1440,128C1600,117,1760,139,1920,160L1920,320L0,320Z"></path>
      </svg>
    </div>
  </div>
  
  <div class="container mt-0 mb-2">
    <div class="d-flex justify-content-between align-items-center custom-border pb-2">
      <h2 class="heading-line mb-0">Most Popular</h2>
    </div>
  </div>
  <!-- Carousel -->
  <div class="carousel-wrapper">
    <div id="bookCarousel" class="carousel slide mt-0" data-bs-ride="carousel">
      <div class="carousel-inner">

        <!-- Slide 1 -->
        <div class="carousel-item active">
          <div class="d-flex justify-content-evenly flex-nowrap gap-4">
            <th:block th:each="book : ${recommendedBooks.subList(0, recommendedBooks.size() > 4 ? 4 : recommendedBooks.size())}">
              <a th:href="@{'/book/' + ${book.id}}" class="text-decoration-none text-center">
                <img th:src="${book.getImagePath(book.coverImageUrl)}" alt="Copertina" style="height: 250px; border-radius: 8px;">
				<div class="mt-2 text-center">
				  <th:block th:with="avg=${book.averageVote}">
				    <th:block th:with="full=${T(java.lang.Math).floor(avg)}, 
				                       half=${(avg - T(java.lang.Math).floor(avg)) >= 0.25 and (avg - T(java.lang.Math).floor(avg)) < 0.75}">
				      <th:block th:each="i : ${#numbers.sequence(1, 5)}">
				        <i th:if="${i <= full}" class="fa-solid fa-star star-full"></i>
				        <i th:if="${i == full + 1 and half}" class="fa-solid fa-star-half-stroke star-full"></i>
				        <i th:if="${i > full + (half ? 1 : 0)}" class="fa-solid fa-star star-empty"></i>
				      </th:block>
				    </th:block>
				    <div class="small text-muted mt-1" th:text="${#numbers.formatDecimal(avg, 1, 1)} + ' / 5.0'"></div>
				  </th:block>
				</div>
              </a>
            </th:block>
          </div>
        </div>

        <!-- Slide 2 -->
        <div class="carousel-item" th:if="${recommendedBooks.size() > 4}">
          <div class="d-flex justify-content-evenly flex-nowrap gap-4">
            <th:block th:each="book : ${recommendedBooks.subList(4, recommendedBooks.size() > 8 ? 8 : recommendedBooks.size())}">
              <a th:href="@{'/book/' + ${book.id}}" class="text-decoration-none text-center">
                <img th:src="${book.getImagePath(book.coverImageUrl)}" alt="Copertina" style="height: 250px; border-radius: 8px;">
				<div class="mt-2 text-center">
				  <th:block th:with="avg=${book.averageVote}">
				    <th:block th:with="full=${T(java.lang.Math).floor(avg)}, 
				                       half=${(avg - T(java.lang.Math).floor(avg)) >= 0.25 and (avg - T(java.lang.Math).floor(avg)) < 0.75}">
				      <th:block th:each="i : ${#numbers.sequence(1, 5)}">
				        <i th:if="${i <= full}" class="fa-solid fa-star star-full"></i>
				        <i th:if="${i == full + 1 and half}" class="fa-solid fa-star-half-stroke star-full"></i>
				        <i th:if="${i > full + (half ? 1 : 0)}" class="fa-solid fa-star star-empty"></i>
				      </th:block>
				    </th:block>
				    <div class="small text-muted mt-1" th:text="${#numbers.formatDecimal(avg, 1, 1)} + ' / 5.0'"></div>
				  </th:block>
				</div>
              </a>
            </th:block>
          </div>
        </div>

        <!-- Slide 3 -->
        <div class="carousel-item" th:if="${recommendedBooks.size() > 8}">
          <div class="d-flex justify-content-evenly flex-nowrap gap-4">
            <th:block th:each="book : ${recommendedBooks.subList(8, recommendedBooks.size() > 12 ? 12 : recommendedBooks.size())}">
              <a th:href="@{'/book/' + ${book.id}}" class="text-decoration-none text-center">
                <img th:src="${book.getImagePath(book.coverImageUrl)}" alt="Copertina" style="height: 250px; border-radius: 8px;">
				<div class="mt-2 text-center">
				  <th:block th:with="avg=${book.averageVote}">
				    <th:block th:with="full=${T(java.lang.Math).floor(avg)}, 
				                       half=${(avg - T(java.lang.Math).floor(avg)) >= 0.25 and (avg - T(java.lang.Math).floor(avg)) < 0.75}">
				      <th:block th:each="i : ${#numbers.sequence(1, 5)}">
				        <i th:if="${i <= full}" class="fa-solid fa-star star-full"></i>
				        <i th:if="${i == full + 1 and half}" class="fa-solid fa-star-half-stroke star-full"></i>
				        <i th:if="${i > full + (half ? 1 : 0)}" class="fa-solid fa-star star-empty"></i>
				      </th:block>
				    </th:block>
				    <div class="small text-muted mt-1" th:text="${#numbers.formatDecimal(avg, 1, 1)} + ' / 5.0'"></div>
				  </th:block>
				</div>
              </a>
            </th:block>
          </div>
        </div>

      </div>

      <!-- Controlli -->
      <button class="carousel-control-prev" type="button" data-bs-target="#bookCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon"></span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#bookCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon"></span>
      </button>
    </div>


</main>

<!-- Footer -->
<footer class="custom-footer mt-5">
  <div class="container text-center py-2">
    <p class="mb-1">Â© 2025 siw-Books. All rights reserved.</p>
    <div>
      <a href="#" class="footer-link me-3"><i class="fab fa-facebook-f"></i></a>
      <a href="#" class="footer-link me-3"><i class="fab fa-twitter"></i></a>
      <a href="#" class="footer-link"><i class="fab fa-instagram"></i></a>
    </div>
  </div>
</footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
